<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Title</title>
</head>
<body>
<div id="example"></div>
<script type="text/javascript" src="../reactCode/react.development.js"></script>
<script type="text/javascript" src="../reactCode/react-dom.development.js"></script>
<script type="text/javascript" src="../reactCode/babel.min.js"></script>
<script type="text/javascript" src="../reactCode/prop-types.js"></script>
<script type="text/babel">
  /*
  1, 数据保存在哪个组件中？
  单个组件需要
  多个组件需要，放在父组件中

  2, 如何在子组件中更改父组件的状态
  * 子组件不能改变父组件的状态
  * 状态 在哪个组件， 更新状态的行为 就应该 定义在哪个组件
      ** 解决方案： 父组件
  */

  // 父组件
  class App extends React.Component {
    constructor(props) {
      super(props);
      this.state = {
        toDoList: ['sleep', 'eating', 'coding']
      }

      this.addTodo = this.addTodo.bind(this)
    }

    // 更新state
    addTodo(todo) {
      const {toDoList} = this.state;
      // 添加在最前面， push 添加到最后面
      toDoList.unshift(todo);
      // 必须调用 setState中更新状态
      this.setState({toDoList})
    }


    render() {
      const {toDoList} = this.state
      return (
        // 只能有一个根标签
        // <Add > 标签内， 可以传入
        <div>
          <h1>Simple TODO List</h1>
          <Add count={toDoList.length} addTodo={this.addTodo}/>
          <List todos={toDoList}/>
        </div>
      )
    }
  }

  // 子组件
  class Add extends React.Component {
    constructor(props) {
      super(props)

      this.addList = this.addList.bind(this)
    }

    addList() {
      /*
      1, 读取输入的输入
      2, 检查合法性
      3， 添加
      */
      // trim() 去除两端空格
      const todo = this.todoInput.value.trim()
      if(!todo) {
        return
      }
      // 注意： addTodo的位置
      this.props.addTodo(todo)

      // 清楚输入, 输入后，输入框清空
      this.todoInput.value = ''

    }

    render() {
      return (
        <div>
          <input type="text" ref={input => this.todoInput= input}/>
          <button onClick={this.addList}>add #{this.props.count + 1}</button>
        </div>
      )
    }
  }

  Add.propTypes = {
    count: PropTypes.number.isRequired,
    addTodo: PropTypes.func.isRequired
  }

  // 子组件
  class List extends React.Component {
    render() {
      return (
        <ul>
          {
            // map() 函数
            // this.props.todos.map((todo, index) => {return <li key={index}>{todo}</li>})
            this.props.todos.map((todo, index) => <li key={index}> {todo}</li>)
          }
        </ul>
      )
    }
  }

  // 接收数据前， 判断数据类型
  // 在组件外部声明
  List.propTypes = {
    todos: PropTypes.array.isRequired
  }

  ReactDOM.render(<App/>, document.getElementById('example'))
</script>
</body>
</html>


<!--
1, 拆分组件, 组件的边界
2, 实现静态组件（只有静态界面， 没有动态数据， 也没有交互）
3, 实现动态组件
  （1） 实现初始化数据动态显示
  （2） 实现交互功能

-->